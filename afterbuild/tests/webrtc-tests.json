{
    "describe": "WEBRTC API",
    "starring": {
        "admin": {
            "robert": {
                "email": "rford@westworld.com",
                "password": "Password_123"
            }
        },
        "actors": {
            "bernard": {
                "email": "blowe@hostwestworld.com",
                "firstname": "Bernard",
                "lastname": "Lowe",
                "company": "WestworldHost",
                "password": "Password_123"
            },
            "dolores": {
                "email": "dolores@hostwestworld.com",
                "firstname": "Dolores",
                "lastname": "Abernathy",
                "company": "WestworldHost",
                "password": "Password_123"
            }
        },
        "relations": [
            {
                "isActorInRelationWith": {
                    "dolores@hostwestworld.com": "blowe@hostwestworld.com"
                }
            }
        ]
    },
    "runBeforeAll": {
        "it": {
            "should": "Log-in with Dolores and Bernard successfully",
            "by": [
                {
                    "executing": "api:connection.signin",
                    "injecting": [
                        "usr:@.email",
                        "usr:@.password"
                    ],
                    "resulting": "account",
                    "expecting": [
                        {
                            "var:account": "$defined"
                        }
                    ],
                    "using": [
                        "dolores",
                        "bernard"
                    ]
                }
            ]
        }
    },
    "runAfterAll": {
        "it": {
            "should": "Log-out with Dolores and Bernard successfully",
            "by": [
                {
                    "executing": "api:connection.signout",
                    "injecting": [],
                    "resulting": null,
                    "expecting": [],
                    "using": [
                        "dolores",
                        "bernard"
                    ]
                }
            ]
        }
    },
    "run": [
        {
            "it": {
                "should": "Check that Bernard has a microphone and a camera and can make audio/video call",
                "by": [
                    {
                        "executing": "api:webRTC.hasACamera",
                        "injecting": [],
                        "resulting": "hasACamera",
                        "expecting": [
                            {
                                "var:hasACamera": true
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.hasAMicrophone",
                        "injecting": [],
                        "resulting": "hasAMicrophone",
                        "expecting": [
                            {
                                "var:hasAMicrophone": true
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.canMakeAudioVideoCall",
                        "injecting": [],
                        "resulting": "canMakeCall",
                        "expecting": [
                            {
                                "var:canMakeCall": true
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    }
                ]
            }
        },
        {
            "it": {
                "should": "Call Dolores with Bernard in audio and decline the call from Dolores side",
                "by": [
                    {
                        "executing": "api:contacts.searchByLogin",
                        "injecting": [
                            "usr:dolores.email"
                        ],
                        "resulting": "doloresContact",
                        "expecting": [
                            {
                                "var:doloresContact.loginEmail": "#dolores@hostwestworld.com"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.callInAudio",
                        "injecting": [
                            "var:doloresContact"
                        ],
                        "waiting": {
                            "forEvent": "api:webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED",
                            "resulting": "call>id",
                            "using": [
                                "dolores"
                            ]
                        },
                        "resulting": "",
                        "expecting": [
                            {
                                "var:call.id": "$defined",
                                "for": "dolores"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:conversations.getCallById",
                        "injecting": [
                            "var:call.id"
                        ],
                        "resulting": "callReceived",
                        "expecting": [
                            {
                                "var:callReceived": "$defined"
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "api:webRTC.reject",
                        "injecting": [
                            "var:callReceived"
                        ],
                        "resulting": "result",
                        "expecting": [
                            {
                                "var:result.code": 1
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    }
                ]
            }
        },
        {
            "it": {
                "should": "Call Dolores with Bernard in audio and accept the call from Dolores's side in audio and finally release the call from Bernard's side",
                "by": [
                    {
                        "executing": "api:contacts.searchByLogin",
                        "injecting": [
                            "usr:dolores.email"
                        ],
                        "resulting": "doloresContact",
                        "expecting": [
                            {
                                "var:doloresContact.loginEmail": "#dolores@hostwestworld.com"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.callInAudio",
                        "injecting": [
                            "var:doloresContact"
                        ],
                        "waiting": {
                            "forEvent": "api:webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED",
                            "resulting": "call>id",
                            "using": [
                                "dolores"
                            ]
                        },
                        "resulting": "",
                        "expecting": [
                            {
                                "var:call.id": "$defined",
                                "for": "dolores"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:conversations.getCallById",
                        "injecting": [
                            "var:call.id"
                        ],
                        "resulting": "callReceived",
                        "expecting": [
                            {
                                "var:callReceived": "$defined"
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "api:webRTC.answerInAudio",
                        "injecting": [
                            "var:callReceived"
                        ],
                        "waiting": {
                            "forEvent": "api:webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED",
                            "resulting": "call>id",
                            "using": [
                                "bernard"
                            ]
                        },
                        "resulting": "result",
                        "expecting": [
                            {
                                "var:result.code": 1
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 3000
                    },
                    {
                        "executing": "api:conversations.getCallById",
                        "injecting": [
                            "var:call.id"
                        ],
                        "resulting": "callAnswered",
                        "expecting": [
                            {
                                "var:callAnswered": "$defined"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.release",
                        "injecting": [
                            "var:callAnswered"
                        ],
                        "resulting": "result",
                        "expecting": [
                            {
                                "var:result.code": 1
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    }
                ]
            }
        },

        {
            "it": {
                "should": "Call Dolores with Bernard in audio and accept the call from Dolores's side in audio, escalade to video, reberse to audio and finally release the call from Bernard's side",
                "by": [
                    {
                        "executing": "api:contacts.searchByLogin",
                        "injecting": [
                            "usr:dolores.email"
                        ],
                        "resulting": "doloresContact",
                        "expecting": [
                            {
                                "var:doloresContact.loginEmail": "#dolores@hostwestworld.com"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.callInAudio",
                        "injecting": [
                            "var:doloresContact"
                        ],
                        "waiting": {
                            "forEvent": "api:webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED",
                            "resulting": "call>id",
                            "using": [
                                "dolores"
                            ]
                        },
                        "resulting": "",
                        "expecting": [
                            {
                                "var:call.id": "$defined",
                                "for": "dolores"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:conversations.getCallById",
                        "injecting": [
                            "var:call.id"
                        ],
                        "resulting": "callReceived",
                        "expecting": [
                            {
                                "var:callReceived": "$defined"
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "api:webRTC.answerInAudio",
                        "injecting": [
                            "var:callReceived"
                        ],
                        "waiting": {
                            "forEvent": "api:webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED",
                            "resulting": "call>id",
                            "using": [
                                "bernard"
                            ]
                        },
                        "resulting": "result",
                        "expecting": [
                            {
                                "var:result.code": 1
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 3000
                    },
                    {
                        "executing": "api:conversations.getCallById",
                        "injecting": [
                            "var:call.id"
                        ],
                        "resulting": "callAnswered",
                        "expecting": [
                            {
                                "var:callAnswered": "$defined"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.escaladeToVideoCall",
                        "injecting": [
                            "var:call"
                        ],

                        "resulting": "",
                        "expecting": null,
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 3000
                    },
                    {
                        "executing": "api:webRTC.getLocalStreamsFromCall",
                        "injecting": [
                            "var:callAnswered"
                        ],
                        "resulting": "listOfLocalStreams",
                        "expecting": [
                            {
                                "var:listOfLocalStreams": "$defined"
                            },
                            {
                                "var:listOfLocalStreams.length": 1
                            },
                            {
                                "var:listOfLocalStreams[0].getTracks().length": 2
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 3000
                    },
                    {
                        "executing": "api:webRTC.reverseToAudioCall",
                        "injecting": [
                            "var:call"
                        ],
                       
                        "resulting": "",
                        "expecting": null,
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 3000
                    },
                    {
                        "executing": "api:webRTC.getLocalStreamsFromCall",
                        "injecting": [
                            "var:callAnswered"
                        ],
                        "resulting": "listOfLocalStreams",
                        "expecting": [
                            {
                                "var:listOfLocalStreams": "$defined"
                            },
                            {
                                "var:listOfLocalStreams.length": 1
                            },
                            {
                                "var:listOfLocalStreams[0].getTracks().length": 1
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.release",
                        "injecting": [
                            "var:callAnswered"
                        ],
                        "resulting": "result",
                        "expecting": [
                            {
                                "var:result.code": 1
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    }
                ]
            }
        },

        {
            "it": {
                "should": "Call Dolores with Bernard in video, accept the call from Dolores's side in video, check the number of local and remote streams and finally release the call from Bernard's side",
                "by": [
                    {
                        "executing": "api:contacts.searchByLogin",
                        "injecting": [
                            "usr:dolores.email"
                        ],
                        "resulting": "doloresContact",
                        "expecting": [
                            {
                                "var:doloresContact.loginEmail": "#dolores@hostwestworld.com"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.callInVideo",
                        "injecting": [
                            "var:doloresContact"
                        ],
                        "waiting": {
                            "forEvent": "api:webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED",
                            "resulting": "call>id",
                            "using": [
                                "dolores"
                            ]
                        },
                        "resulting": "",
                        "expecting": [
                            {
                                "var:call.id": "$defined",
                                "for": "dolores"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:conversations.getCallById",
                        "injecting": [
                            "var:call.id"
                        ],
                        "resulting": "callReceived",
                        "expecting": [
                            {
                                "var:callReceived": "$defined"
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "api:webRTC.answerInVideo",
                        "injecting": [
                            "var:callReceived"
                        ],
                        "waiting": {
                            "forEvent": "api:webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED",
                            "resulting": "call>id",
                            "using": [
                                "bernard"
                            ]
                        },
                        "resulting": "result",
                        "expecting": [
                            {
                                "var:result.code": 1
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 3000
                    },
                    {
                        "executing": "api:conversations.getCallById",
                        "injecting": [
                            "var:call.id"
                        ],
                        "resulting": "callAnswered",
                        "expecting": [
                            {
                                "var:callAnswered": "$defined"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.getLocalStreamsFromCall",
                        "injecting": [
                            "var:callAnswered"
                        ],
                        "resulting": "listOfLocalStreams",
                        "expecting": [
                            {
                                "var:listOfLocalStreams": "$defined"
                            },
                            {
                                "var:listOfLocalStreams.length": 1
                            },
                            {
                                "var:listOfLocalStreams[0].getTracks().length": 2
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.getRemoteStreamsFromCall",
                        "injecting": [
                            "var:callAnswered"
                        ],
                        "resulting": "listOfRemoteStreams",
                        "expecting": [
                            {
                                "var:listOfRemoteStreams": "$defined"
                            },
                            {
                                "var:listOfRemoteStreams.length": 1
                            },
                            {
                                "var:listOfLocalStreams[0].getTracks().length": 2
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.release",
                        "injecting": [
                            "var:callAnswered"
                        ],
                        "resulting": "result",
                        "expecting": [
                            {
                                "var:result.code": 1
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    }
                ]
            }
        },
        {
            "it": {
                "should": "Call Dolores with Bernard in audio and accept the call from Dolores's side in audio, then mute and unmute the audio and finally release the call from Bernard's side",
                "by": [
                    {
                        "executing": "api:contacts.searchByLogin",
                        "injecting": [
                            "usr:dolores.email"
                        ],
                        "resulting": "doloresContact",
                        "expecting": [
                            {
                                "var:doloresContact.loginEmail": "#dolores@hostwestworld.com"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.callInAudio",
                        "injecting": [
                            "var:doloresContact"
                        ],
                        "waiting": {
                            "forEvent": "api:webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED",
                            "resulting": "call>id",
                            "using": [
                                "dolores"
                            ]
                        },
                        "resulting": "",
                        "expecting": [
                            {
                                "var:call.id": "$defined",
                                "for": "dolores"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:conversations.getCallById",
                        "injecting": [
                            "var:call.id"
                        ],
                        "resulting": "callReceived",
                        "expecting": [
                            {
                                "var:callReceived": "$defined"
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "api:webRTC.answerInAudio",
                        "injecting": [
                            "var:callReceived"
                        ],
                        "waiting": {
                            "forEvent": "api:webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED",
                            "resulting": "call>id",
                            "using": [
                                "bernard"
                            ]
                        },
                        "resulting": "result",
                        "expecting": [
                            {
                                "var:result.code": 1
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 3000
                    },
                    {
                        "executing": "api:conversations.getConversationById",
                        "injecting": [
                            "var:callReceived.conversationId"
                        ],
                        "resulting": "conversationReceived",
                        "expecting": [
                            {
                                "var:conversationReceived": "$defined"
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "api:webRTC.muteAudioCall",
                        "injecting": [
                            "var:conversationReceived"
                        ],
                        "resulting": "",
                        "expecting": [],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 1000
                    },
                    {
                        "executing": "api:webRTC.unmuteAudioCall",
                        "injecting": [
                            "var:conversationReceived"
                        ],
                        "resulting": "",
                        "expecting": [],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 1000
                    },
                    {
                        "executing": "api:conversations.getCallById",
                        "injecting": [
                            "var:call.id"
                        ],
                        "resulting": "callAnswered",
                        "expecting": [
                            {
                                "var:callAnswered": "$defined"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.release",
                        "injecting": [
                            "var:callAnswered"
                        ],
                        "resulting": "result",
                        "expecting": [
                            {
                                "var:result.code": 1
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    }
                ]
            }
        },
        {
            "it": {
                "should": "Call Dolores with Bernard in video and decline the call from Dolores side",
                "by": [
                    {
                        "executing": "api:contacts.searchByLogin",
                        "injecting": [
                            "usr:dolores.email"
                        ],
                        "resulting": "doloresContact",
                        "expecting": [
                            {
                                "var:doloresContact.loginEmail": "#dolores@hostwestworld.com"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.callInVideo",
                        "injecting": [
                            "var:doloresContact"
                        ],
                        "waiting": {
                            "forEvent": "api:webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED",
                            "resulting": "call>id",
                            "using": [
                                "dolores"
                            ]
                        },
                        "resulting": "",
                        "expecting": [
                            {
                                "var:call.id": "$defined",
                                "for": "dolores"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:conversations.getCallById",
                        "injecting": [
                            "var:call.id"
                        ],
                        "resulting": "callReceived",
                        "expecting": [
                            {
                                "var:callReceived": "$defined"
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "api:webRTC.reject",
                        "injecting": [
                            "var:callReceived"
                        ],
                        "resulting": "result",
                        "expecting": [
                            {
                                "var:result.code": 1
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    }
                ]
            }
        },
        {
            "it": {
                "should": "Call Dolores with Bernard in video and accept the call from Dolores's side in video, then hide and show media and finally release the call from Bernard's side",
                "by": [
                    {
                        "executing": "api:contacts.searchByLogin",
                        "injecting": [
                            "usr:dolores.email"
                        ],
                        "resulting": "doloresContact",
                        "expecting": [
                            {
                                "var:doloresContact.loginEmail": "#dolores@hostwestworld.com"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.callInVideo",
                        "injecting": [
                            "var:doloresContact"
                        ],
                        "waiting": {
                            "forEvent": "api:webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED",
                            "resulting": "call>id",
                            "using": [
                                "dolores"
                            ]
                        },
                        "resulting": "",
                        "expecting": [
                            {
                                "var:call.id": "$defined",
                                "for": "dolores"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:conversations.getCallById",
                        "injecting": [
                            "var:call.id"
                        ],
                        "resulting": "callReceived",
                        "expecting": [
                            {
                                "var:callReceived": "$defined"
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "api:webRTC.answerInVideo",
                        "injecting": [
                            "var:callReceived"
                        ],
                        "waiting": {
                            "forEvent": "api:webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED",
                            "resulting": "call>id",
                            "using": [
                                "bernard"
                            ]
                        },
                        "resulting": "result",
                        "expecting": [
                            {
                                "var:result.code": 1
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 3000
                    },
                    {
                        "executing": "api:webRTC.hideLocalVideo",
                        "injecting": [],
                        "resulting": "",
                        "expecting": [],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 1000
                    },
                    {
                        "executing": "api:webRTC.showLocalVideo",
                        "injecting": [],
                        "resulting": "",
                        "expecting": [],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 1000
                    },
                    {
                        "executing": "api:webRTC.hideRemoteVideo",
                        "injecting": [
                            "var:callReceived"
                        ],
                        "resulting": "",
                        "expecting": [],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 1000
                    },
                    {
                        "executing": "api:webRTC.showRemoteVideo",
                        "injecting": [
                            "var:callReceived"
                        ],
                        "resulting": "",
                        "expecting": [],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 1000
                    },
                    {
                        "executing": "api:conversations.getCallById",
                        "injecting": [
                            "var:call.id"
                        ],
                        "resulting": "callAnswered",
                        "expecting": [
                            {
                                "var:callAnswered": "$defined"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.release",
                        "injecting": [
                            "var:callAnswered"
                        ],
                        "resulting": "result",
                        "expecting": [
                            {
                                "var:result.code": 1
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    }
                ]
            }
        },
        {
            "it": {
                "should": "Call Dolores with Bernard in video and accept the call from Dolores's side in video, then mute and unmute the video and finally release the call from Bernard's side",
                "by": [
                    {
                        "executing": "api:contacts.searchByLogin",
                        "injecting": [
                            "usr:dolores.email"
                        ],
                        "resulting": "doloresContact",
                        "expecting": [
                            {
                                "var:doloresContact.loginEmail": "#dolores@hostwestworld.com"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.callInVideo",
                        "injecting": [
                            "var:doloresContact"
                        ],
                        "waiting": {
                            "forEvent": "api:webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED",
                            "resulting": "call>id",
                            "using": [
                                "dolores"
                            ]
                        },
                        "resulting": "",
                        "expecting": [
                            {
                                "var:call.id": "$defined",
                                "for": "dolores"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:conversations.getCallById",
                        "injecting": [
                            "var:call.id"
                        ],
                        "resulting": "callReceived",
                        "expecting": [
                            {
                                "var:callReceived": "$defined"
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "api:webRTC.answerInVideo",
                        "injecting": [
                            "var:callReceived"
                        ],
                        "waiting": {
                            "forEvent": "api:webRTC.RAINBOW_ONWEBRTCCALLSTATECHANGED",
                            "resulting": "call>id",
                            "using": [
                                "bernard"
                            ]
                        },
                        "resulting": "result",
                        "expecting": [
                            {
                                "var:result.code": 1
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 3000
                    },
                    {
                        "executing": "api:conversations.getConversationById",
                        "injecting": [
                            "var:callReceived.conversationId"
                        ],
                        "resulting": "conversationReceived",
                        "expecting": [
                            {
                                "var:conversationReceived": "$defined"
                            }
                        ],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "api:webRTC.muteVideoCall",
                        "injecting": [
                            "var:conversationReceived"
                        ],
                        "resulting": "",
                        "expecting": [],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 1000
                    },
                    {
                        "executing": "api:webRTC.unmuteVideoCall",
                        "injecting": [
                            "var:conversationReceived"
                        ],
                        "resulting": "",
                        "expecting": [],
                        "using": [
                            "dolores"
                        ]
                    },
                    {
                        "executing": "exe:pause",
                        "duration": 1000
                    },
                    {
                        "executing": "api:conversations.getCallById",
                        "injecting": [
                            "var:call.id"
                        ],
                        "resulting": "callAnswered",
                        "expecting": [
                            {
                                "var:callAnswered": "$defined"
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.release",
                        "injecting": [
                            "var:callAnswered"
                        ],
                        "resulting": "result",
                        "expecting": [
                            {
                                "var:result.code": 1
                            }
                        ],
                        "using": [
                            "bernard"
                        ]
                    }
                ]
            }
        },
        {
            "it": {
                "should": "Select a specific microphone camera and speaker for Bernard",
                "by": [
                    {
                        "executing": "api:webRTC.useSpeaker",
                        "injecting": [
                            "default"
                        ],
                        "resulting": "",
                        "expecting": [],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.useCamera",
                        "injecting": [
                            "default"
                        ],
                        "resulting": "",
                        "expecting": [],
                        "using": [
                            "bernard"
                        ]
                    },
                    {
                        "executing": "api:webRTC.useMicrophone",
                        "injecting": [
                            "default"
                        ],
                        "resulting": "",
                        "expecting": [],
                        "using": [
                            "bernard"
                        ]
                    }
                ]
            }
        }
    ]
}